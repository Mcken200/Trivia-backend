<!DOCTYPE html>
<html>
<head>
  <title>Trivia Game</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
  <body>
    <div id="qrContainer" style="position: fixed; top: 1rem; right: 1rem;"></div>

    <h1>Welcome to the Trivia Game!</h1>
    <p>Connecting to the server...</p>
    <button id="startBtn">Start Game</button>

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
    window.addEventListener('DOMContentLoaded', () => {
        const socket = io();
        console.log('Connected to server with ID:', socket.id);

        document.getElementById('startBtn').onclick = () => {
            const gameId = Math.floor(1000 + Math.random() * 9000).toString();
            socket.emit('createGame', gameId);
            
            const joinUrl = `${window.location.origin}/join.html?gameId=${gameId}`;
            showQRCode(joinUrl);
            
            socket.emit('host_start_game', {
                gameId,
                joinUrl
            });
        };

        function showQRCode(joinUrl) {
            console.log("Showing QR code for:", joinUrl);
            const qrCodeContainer = document.getElementById("qrContainer");
            qrCodeContainer.innerHTML = ''; // Clear any previous QR
            new QRCode(qrCodeContainer, {
                text: joinUrl,
                width: 256,
                height: 256
            });
        }
    });
    </script>
  </body>
</html>